import{G as R}from"./index-ee1133ea.js";import{s as g,t as T}from"./SimpleGeometryCursor-e3941f41.js";import{b as q,j as w,a as l,e as S,L as j}from"./Transformation2D-6dd5ab6c.js";import{n as y,w as k,az as I,P as v,C as $}from"./ProjectionTransformation-5bc4f99e.js";import{getSpatialReference as C,toGeometry as D,fromSpatialReference as E,fromGeometry as d}from"./apiConverter-0d48c0e6.js";class A{getOperatorType(){return 10003}supportsCurves(){return!0}accelerateGeometry(e,n,o){return!1}canAccelerateGeometry(e){return!1}executeMany(e,n,o,r){return new Y(e,n,o,r)}execute(e,n,o,r){const i=new g([e]),c=new g([n]),s=this.executeMany(i,c,o,r).next();return s||q("null output"),s}}function O(t,e,n,o){const r=t.getDimension(),i=e.getDimension();if(r!==i)return r>i?t:e;if(t.isEmpty())return e;if(e.isEmpty())return t;const c=new y,s=new y,u=new y;t.queryEnvelope(c),e.queryEnvelope(s),u.setCoords({env2D:c}),u.mergeEnvelope2D(s);const a=k(n,u,!0),f=t.getGeometryType(),p=e.getGeometryType();return f===l.enumPoint&&p===l.enumPoint?X(t,e,a):f===l.enumPoint&&p===l.enumMultiPoint?P(e,t,a):f===l.enumMultiPoint&&p===l.enumPoint?P(t,e,a):I(t,e,n,o)}function X(t,e,n,o){const r=v(n),i=r*r,c=t.getXY(),s=e.getXY(),u=new $({vd:t.getDescription()});return S.sqrDistance(c,s)>i&&(u.add(t),u.add(e)),u}function P(t,e,n,o){const r=t.getImpl().getAttributeStreamRef(0),i=t.getPointCount(),c=e.getXY(),s=t.createInstance(),u=v(n),a=new y;if(t.queryEnvelope(a),a.inflateCoords(u,u),a.contains(c)){const f=u*u;let p=!1;const _=j(i,!1);for(let m=0;m<i;m++){const b=r.read(2*m),M=r.read(2*m+1),x=b-c.x,G=M-c.y;x*x+G*G<=f&&(p=!0,_[m]=!0)}if(p)for(let m=0;m<i;m++)_[m]||s.addPoints(t,m,m+1);else s.addPoints(t,0,i),s.add(e)}else s.addPoints(t,0,i),s.add(e);return s}class Y extends T{constructor(e,n,o,r){super(),this.m_progressTracker=r,this.m_index=-1,this.m_inputGeoms=e,this.m_spatialReference=o,this.m_rightGeom=n.next(),this.m_bEmpty=!this.m_rightGeom,w(this.m_rightGeom)}tock(){return!0}getRank(){return 1}next(){if(this.m_bEmpty)return null;const e=this.m_inputGeoms.next();return e?(w(e),this.m_index=this.m_inputGeoms.getGeometryID(),O(e,this.m_rightGeom,this.m_spatialReference,this.m_progressTracker)):null}getGeometryID(){return this.m_index}}const h=new A;function z(t,e,n){return h.execute(t,e,n,null)}function L(t,e,n){const o=h.executeMany(new g(t),new g([e]),n,null);return Array.from(o)}function Z(){return h.supportsCurves()}function B(t,e){const n=C(t);return D(z(d(t),d(e),E(n)),n)}function F(t,e){const n=t.map(d),o=C(t);return L(n,d(e),E(o)).map(r=>D(r,o)).filter(R)}const H=Z(),V=Object.freeze(Object.defineProperty({__proto__:null,execute:B,executeMany:F,supportsCurves:H},Symbol.toStringTag,{value:"Module"}));export{F as c,V as i,H as m,B as u};
